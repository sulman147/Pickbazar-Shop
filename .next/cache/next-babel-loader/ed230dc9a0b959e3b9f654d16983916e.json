{"ast":null,"code":"import _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral\";\nvar __jsx = React.createElement;\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query getAllOrders($text: String, $user: Int!, $limit: Int) {\\n    orders(text: $text, limit: $limit, user: $user) {\\n      id\\n      status\\n      deliveryAddress\\n      amount\\n      date\\n      subtotal\\n      deliveryFee\\n      discount\\n      deliveryTime\\n      products {\\n        title\\n        price\\n        total\\n        image\\n        weight\\n        quantity\\n        id\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState, useEffect } from 'react';\nimport gql from 'graphql-tag';\nimport { Scrollbars } from 'react-custom-scrollbars';\nimport { useQuery } from '@apollo/react-hooks';\nimport { OrderBox, OrderListWrapper, OrderList, OrderDetailsWrapper, Title, ImageWrapper, ItemWrapper, ItemDetails, ItemName, ItemSize, ItemPrice, NoOrderFound } from './Order.style';\nimport OrderDetails from './SingleOrderDetails/OrderDetails';\nimport OrderCard from './OrderCard/OrderCard';\nimport OrderCardMobile from './OrderCard/orderCardMobile';\nimport useComponentSize from 'helper/useComponentSize';\nimport { FormattedMessage } from 'react-intl';\nvar progressData = ['Order Received', 'Order On The Way', 'Order Delivered'];\nvar GET_ORDERS = gql(_templateObject());\nvar orderTableColumns = [{\n  title: __jsx(FormattedMessage, {\n    id: \"cartItems\",\n    defaultMessage: \"Items\"\n  }),\n  dataIndex: '',\n  key: 'items',\n  render: function render(text, record) {\n    return __jsx(ItemWrapper, null, __jsx(ImageWrapper, null, __jsx(\"img\", {\n      src: record.image,\n      alt: record.title\n    })), __jsx(ItemDetails, null, __jsx(ItemName, null, record.title), __jsx(ItemSize, null, record.weight), __jsx(ItemPrice, null, \"$\", record.price)));\n  }\n}, {\n  title: __jsx(FormattedMessage, {\n    id: \"intlTableColTitle2\",\n    defaultMessage: \"Quantity\"\n  }),\n  dataIndex: 'quantity',\n  key: 'quantity',\n  align: 'center'\n}, {\n  title: __jsx(FormattedMessage, {\n    id: \"intlTableColTitle3\",\n    defaultMessage: \"Price\"\n  }),\n  dataIndex: '',\n  key: 'price',\n  align: 'right',\n  render: function render(text, record) {\n    return __jsx(\"p\", null, \"$\", record.total);\n  }\n}];\n\nvar OrdersContent = function OrdersContent(_ref) {\n  var _ref$deviceType = _ref.deviceType,\n      mobile = _ref$deviceType.mobile,\n      tablet = _ref$deviceType.tablet,\n      desktop = _ref$deviceType.desktop;\n\n  var _useState = useState(null),\n      order = _useState[0],\n      setOrder = _useState[1];\n\n  var _useState2 = useState(''),\n      active = _useState2[0],\n      setActive = _useState2[1];\n\n  var _useComponentSize = useComponentSize(),\n      _useComponentSize2 = _slicedToArray(_useComponentSize, 2),\n      targetRef = _useComponentSize2[0],\n      size = _useComponentSize2[1];\n\n  var orderListHeight = size.height - 79;\n\n  var _useQuery = useQuery(GET_ORDERS, {\n    variables: {\n      limit: 7,\n      user: 1\n    }\n  }),\n      data = _useQuery.data,\n      error = _useQuery.error,\n      loading = _useQuery.loading;\n\n  useEffect(function () {\n    if (data.orders && data.orders.length !== 0) {\n      setOrder(data.orders[0]);\n      setActive(data.orders[0].id);\n    }\n  }, [data.orders]);\n\n  if (loading) {\n    return __jsx(\"div\", null, \"loading...\");\n  }\n\n  if (error) return __jsx(\"div\", null, error.message);\n\n  var handleClick = function handleClick(order) {\n    setOrder(order);\n    setActive(order.id);\n  };\n\n  console.log(data.orders, 'data.orders', order, 'order');\n  return __jsx(OrderBox, null, desktop && __jsx(React.Fragment, null, __jsx(OrderListWrapper, {\n    style: {\n      height: size.height\n    }\n  }, __jsx(Title, {\n    style: {\n      padding: '0 20px'\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"intlOrderPageTitle\",\n    defaultMessage: \"My Order\"\n  })), __jsx(Scrollbars, {\n    universal: true,\n    autoHide: true,\n    autoHeight: true,\n    autoHeightMin: 420,\n    autoHeightMax: isNaN(orderListHeight) ? 500 : orderListHeight\n  }, __jsx(OrderList, null, data.orders.length !== 0 ? data.orders.map(function (order) {\n    return __jsx(OrderCard, {\n      key: order.id,\n      orderId: order.id,\n      className: order && order.id === active ? 'active' : '',\n      status: progressData[order.status - 1],\n      date: order.date,\n      deliveryTime: order.deliveryTime,\n      amount: order.amount,\n      onClick: function onClick() {\n        handleClick(order);\n      }\n    });\n  }) : __jsx(NoOrderFound, null, __jsx(FormattedMessage, {\n    id: \"intlNoOrderFound\",\n    defaultMessage: \"No order found\"\n  }))))), __jsx(OrderDetailsWrapper, {\n    ref: targetRef\n  }, __jsx(Title, {\n    style: {\n      padding: '0 20px'\n    }\n  }, __jsx(FormattedMessage, {\n    id: \"orderDetailsText\",\n    defaultMessage: \"Order Details\"\n  })), order && order.id && __jsx(OrderDetails, {\n    progressStatus: order.status,\n    progressData: progressData,\n    address: order.deliveryAddress,\n    subtotal: order.subtotal,\n    discount: order.discount,\n    deliveryFee: order.deliveryFee,\n    grandTotal: order.amount,\n    tableData: order.products,\n    columns: orderTableColumns\n  }))), (mobile || tablet) && __jsx(OrderList, null, __jsx(OrderCardMobile, {\n    orders: data.orders,\n    className: order && order.id === active ? 'active' : '',\n    progressData: progressData,\n    columns: orderTableColumns,\n    onClick: function onClick() {\n      handleClick(order);\n    }\n  })));\n};\n\nexport default OrdersContent;","map":null,"metadata":{},"sourceType":"module"}